<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
    <title>flower-picker demo</title>
    <script src="../../../webcomponentsjs/webcomponents-lite.js"></script>
    <link rel="import" href="../flower-picker.html">
    <link rel="import" href="../../../polymer/polymer.html">
    <link rel="import" href="../../../polymer-gestures/polymer-gestures.html">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="container">
      <flower-picker radius="100" on-selected="handleSelected" touch-action="none"></flower-picker>
    </div>
    <div id="pickedElement"></div>
    <script>
      var fp = document.querySelector('flower-picker');
      var readyForFinish = false;
      var readyForStart  = true;
      
      fp.addEventListener('selected', function (evt) {
        document.querySelector('#pickedElement').innerHTML = 'selected: ' + evt.detail.value;
      });
      
      function handleDown(evt) {
        if (readyForStart) {
          console.log('down')
          readyForFinish = false;
          readyForStart = false;
          setTimeout(function () {
            readyForFinish = true;
            console.log('reset');
          }, 200);
          fp.start({x: evt.clientX, y: evt.clientY});
        }
      }
      
      function handleUp(evt) {
        if (readyForFinish) {
          readyForFinish = false;
          readyForStart = true;
          console.log('up')
          fp.finish({x: evt.clientX, y: evt.clientY});
        }
      }
      
      fp.addEventListener('down', handleDown);
      fp.addEventListener('up', handleUp);
      
      //- fp.addEventListener('mousedown', handleDown);
      //- fp.addEventListener('mouseup', handleUp);
      //- fp.addEventListener('touchdown', handleDown);
      //- fp.addEventListener('touchup', handleUp);
      
      
      var petals = [
        {
          model: {foo: 3, bar: 'bar'},
          display: (function (model) { return model.bar }),
          value: (function (model) { return model.bar }),
          isLeaf: true
        },
        {
          model: 'group',
          isLeaf: false,
          children: [
            {
              model: {foo: 3, bar: 'bar'},
              display: function (model) { return 'foo: ' + model.foo },
              isLeaf: true
            }
          ]
        }
      ]
      fp.petals = petals;
    </script>
  </body>
</html>